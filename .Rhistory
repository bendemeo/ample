pdf('plots/pbmc_grid_vs_clustcounts.pdf', 8,5)
ggplot(pbmc_nonwt, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
geom_boxplot(aes(group= paste0(variable,cut_width(gridSize,0.03))))
def.off()
dev.off()
pbmc_wt = fread('target/experiments/gsGridTest_clustcounts_wt.txt.1')
pbmc_wt = melt(pbmc_nonwt, id.vars=c('gridSize','max_min_dist', 'time'), measure.vars=c('b_cells','cd14_monocytes', "cd4_t_helper",   "cd56_nk",
"cytotoxic_t",    "memory_t",       "regulatory_t"))
pbmc_wt = fread('target/experiments/gsGridTest_clustcounts_wt.txt.1')
View(pbmc_wt)
pbmc_wt = melt(pbmc_wt, id.vars=c('gridSize','max_min_dist', 'time'), measure.vars=c('b_cells','cd14_monocytes', "cd4_t_helper",   "cd56_nk",
"cytotoxic_t",    "memory_t",       "regulatory_t"))
pbmc_grid_nonrandom = fread('target/experiments/pbmc_gridLSHTest_clustcounts.txt.1')
View(pbmc_grid_nonrandom)
colnames(pbmc_grid_nonrandom)
pbmc_grid_nonrandom = melt(pbmc_grid_nonrandom, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
ggplot(pbmc_nonwt, aes(x=gridSize, y=value, color=variable))+
facet_wrap(~value)
ggplot(pbmc_nonwt, aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)
ggplot(pbmc_nonwt, aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts.pdf', 10, 8)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
dev.off()
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts.pdf', 10, 8)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
dev.off()
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts.pdf', 12, 8)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
dev.off()
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts.pdf', 20, 8)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
dev.off()
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts.pdf', 15, 8)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
dev.off()
pdf('plots/pbmc_gridLSH_nonrandom_size_vs_clustCounts_all.pdf', 10, 6)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
dev.off()
pbmc_nonwt_2 = fread('target/experiments/pbmc_gsGridTest_clustcounts_nonwt.txt.1')
colnames(pbmc_nonwt_2(
colnames(pbmc_nonwt_2)
pbmc_nonwt_2 = melt(pbmc_nonwt_2, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
colnames(pbmc_nonwt_2)
pbmc_nonwt_2 = melt(pbmc_nonwt_2, id.vars=c("max_min_dist","time","maxCounts","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
pbmc_grid_random = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin.txt.1')
pbmc_grid_random = melt(pbmc_grid_random, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
acet_wrap(~variable)+
geom_smooth(span=0.1)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
facet_wrap(~variable)+
geom_smooth(span=0.1)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
pdf('plots/pbmc_gridLSH_random_size_vs_clustCounts_all.pdf', 10, 6)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
dev.off()
View(pbmc_grid_random)
2970/3
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.01)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_line()
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
geom_boxplot(aes(group= paste0(variable,cut_width(gridSize,0.03))))
ggplot(pbmc_nonwt_2, aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random_short = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_short.txt.1)
pbmc_grid_random_short = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_short.txt.1')
pbmc_grid_random_short = melt(pbmc_grid_random_short, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random_short %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_nonrandom_short = melt(pbmc_grid_nonrandom_short, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random_short = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_short.txt.1')
pbmc_grid_nonrandom_short = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_short.txt.1')
pbmc_grid_random_short = melt(pbmc_grid_random_short, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_nonrandom_short = melt(pbmc_grid_nonrandom_short, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_nonrandom_short %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_random_short %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_nonrandom_short %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
View(pbmc_grid_random)
View(pbmc_grid_nonrandom)
scores = fread('target/experiments/pbmc_gridLSHTest_clustcounts_.txt.3')
colnames(scores)
paste0(colnames(scores,sep=','))
paste0(colnames(scores),sep=',')
paste0(colnames(scores),collapse=',')
paste0("'",colnames(scores),"'",collapse=',')
scores <- melt(scores, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c('CD14+_Monocyte','CD19+_B','CD4+/CD25_T_Reg','CD4+/CD45RA+/CD25-_Naive_T',
'CD4+/CD45RO+_Memory','CD4+_T_Helper2','CD56+_NK','CD8+/CD45RA+_Naive_Cytotoxic',
'CD8+_Cytotoxic_T','Dendritic','CD14+_Monocyte_score','CD19+_B_score',
'CD4+/CD25_T_Reg_score','CD4+/CD45RA+/CD25-_Naive_T_score','CD4+/CD45RO+_Memory_score',
'CD4+_T_Helper2_score','CD56+_NK_score','CD8+/CD45RA+_Naive_Cytotoxic_score',
'CD8+_Cytotoxic_T_score','Dendritic_score')    )
ggplot(scores, aes(x=gridSize,y=value, color=variable))+
geom_line()
pbmc_grid_random = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_.txt.2')
pbmc_grid_nonrandom = melt(pbmc_grid_nonrandom, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random = melt(pbmc_grid_random, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
colnames(pbmc_grid_nonrandom)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=value, color=variable))+
geom_smooth(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=value, color=variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts^2, y=value, color=variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_line(span=0.1)
pbmc_grid_random %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.2)
colnames(pbmc_grid_random)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=max_min_dist, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=max_min_dist, y=value, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=max_min_dist, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=value, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=maxCounts, y=max_min_dist, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCountst, color = variable))+
geom_line(span=0.1)
pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts, color = variable))+
geom_line(span=0.1)
?grid.arrange
library(gridExtra)
library(gridExtra)
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts, color = variable))+
geom_line(span=0.1)
g2
?grid.arrange
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_line(span=0.1)
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_line(span=0.1)
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist, color = variable))+
geom_line(span=0.1)
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts, color = variable))+
geom_line(span=0.1)
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_line(span=0.1)
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts))+
geom_line(span=0.1)
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'bottom')
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
lab(y = 'Membership in size-1000 subsample')
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')
grid.arrange(g0,g1,g2)
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts))+
geom_line(span=0.1)+
labs(y = 'grid squares occupied')
grid.arrange(g0,g1,g2)
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_line(span=0.1)+
labs(y = 'Hausdorff distance')
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts))+
geom_line(span=0.1)+
labs(y = 'grid squares occupied')
grid.arrange(g0,g1,g2)
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot()+
labs(y = 'Hausdorff distance')
g1
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = gridSize))+
labs(y = 'Hausdorff distance')
g1
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = gridSize))+
geom_line()
g1
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = gridSize))+
labs(y = 'Hausdorff distance')
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts))+
geom_line(span=0.1)+
labs(y = 'grid squares occupied')
grid.arrange(g0,g1,g2)
grid.arrange(g0,g1,g2)+
theme(title = 'PBMC 68K gridLSH')
grid.arrange(g0,g1,g2)+
ggtitle('PBMC 68K gridLSH')
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')+
ggtitle('PBMC 68K gridLSH')
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')+
ggtitle('PBMC 68K gridLSH')
grid.arrange(g0,g1,g2)
pdf('plots/pbmc_68k_gridtests.pdf')
grid.arrange(g0,g1,g2)
dev.off()
sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=rare))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))
sizetest=fread('target/experiments/gsGridTest.txt.3')
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=max_min_dist))+
geom_line()
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=max_min_dist))+
geom_boxplot(aes(group= cut_number(maxCounts, 10)))
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=max_min_dist))+
geom_boxplot(aes(group= cut_number(maxCounts, 5)))
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=max_min_dist))+
geom_boxplot(aes(group= cut_number('maxCounts', 5)))
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=max_min_dist))+
geom_boxplot(aes(group= cut_width(maxCounts,1)))
sizetest %>% filter(N==500) %>%
ggplot(aes(x=maxCounts,y=rare))+
geom_point()
g1 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=maxCounts))+
geom_point()
g1
g2 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group=cut_width(gridSize,0.03)))
g2
g2 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))
g2
pdf('plots/293Tjurkat_gridtests.pdf')
grid.arrange(r0,r1,r2)
dev.off()
grid.arrange(r0,r1,r2)
r0 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=rare))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))
r1 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=maxCounts))+
geom_point()
r2 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))
pdf('plots/293Tjurkat_gridtests.pdf')
grid.arrange(r0,r1,r2)
dev.off()
grid.arrange(r0,r1,r2)
pdf('plots/293Tjurkat_gridtests.pdf')
grid.arrange(r0,r2,r1)
dev.off()
grid.arrange(r0,r2,r1)
r0 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=rare))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))+
ggtitle('293T Jurkat grid size tests')+
labs(y='Rare cells in 500')
r1 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=maxCounts))+
geom_point()+
labs(y='Occupied grid squares')
r2 = sizetest %>% filter(N==500) %>%
ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group=cut_width(gridSize,0.01)))+
labs(y='Hausdorff distance')
grid.arrange(r0,r2,r1)
pdf('plots/293Tjurkat_gridtests.pdf')
grid.arrange(r0,r2,r1)
dev.off()
pdf('plots/pbmc_68k_gridtests.pdf', 8, 12)
grid.arrange(g0,g1,g2)
dev.off()
?grid.arrange
g0 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=value, color=variable))+
geom_smooth(span=0.1)+
theme(legend.position = 'top')+
labs(y = 'Membership in size-1000 subsample')+
ggtitle('PBMC 68K gridLSH')
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = gridSize))+
labs(y = 'Hausdorff distance')
g2 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=maxCounts))+
geom_line(span=0.1)+
labs(y = 'grid squares occupied')
pdf('plots/pbmc_68k_gridtests.pdf', 8, 12)
grid.arrange(g0,g1,g2)
dev.off()
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = cut_number(gridSize,1)))+
labs(y = 'Hausdorff distance')
g1
g1 = pbmc_grid_nonrandom %>% ggplot(aes(x=gridSize, y=max_min_dist))+
geom_boxplot(aes(group = gridSize))+
labs(y = 'Hausdorff distance')
g1
pdf('plots/pbmc_68k_gridtests.pdf', 12, 12)
grid.arrange(g0,g1,g2)
dev.off()
sum(pbmc_grid_random$time)
sum(pbmc_grid_nonrandom$time)
mean(pbmc_grid_random$time)
mean(pbmc_grid_nonrandom$time)
nrow(pbmc_grid_nonrandom)
nrow(pbmc_grid_random)
hist(pbmc_grid_random$time)
ggplot(pbmc_grid_random, aes(x=gridSize, y=time))+
geom_lines()
ggplot(pbmc_grid_random, aes(x=gridSize, y=time))+
geom_line()
ggplot(pbmc_grid_random, aes(x=gridSize, y=time))+
geom_smooth()
ggplot(pbmc_grid_random, aes(x=maxCounts, y=time))+
geom_smooth()
colnames(pbmc_grid_random)
ggplot(pbmc_grid_random, aes(x=maxCounts, y=time))+
geom_points()
ggplot(pbmc_grid_random, aes(x=maxCounts, y=time))+
geom_point()
tree = fread('target/experiments/pbmc_treeLSHTest_clustcounts_.txt.1')
colnames(tree)
tree = melt(tree, id.vars=c("max_min_dist","time","occSquares", "children", "splitSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
tree %>% ggplot(aes(x=N, y=value, color = variable))+
geom_line()
tree = fread('target/experiments/pbmc_treeLSHTest_clustcounts_.txt.1')
tree = melt(tree, id.vars=c("max_min_dist","time","occSquares", "children", "splitSize", "N"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
tree %>% ggplot(aes(x=N, y=value, color = variable))+
geom_line()
pbmc_grid_nonrandom %>% filter(gridSize=0.3) %>%
ggplot(aes(x=N, y=value, color = variable))+
geom_line()
pbmc_grid_nonrandom %>% filter(gridSize==0.3) %>%
ggplot(aes(x=N, y=value, color = variable))+
geom_line()
pbmc_nonwt = fread('target/experiments/gsGridTest_clustcounts_nonwt.txt.1')
pbmc_nonwt_2 = fread('target/experiments/pbmc_gsGridTest_clustcounts_nonwt.txt.1')
pbmc_wt = fread('target/experiments/gsGridTest_clustcounts_wt.txt.1')
pbmc_grid_nonrandom = fread('target/experiments/pbmc_gridLSHTest_clustcounts.txt.1')
pbmc_grid_random = fread('target/experiments/pbmc_gridLSHTest_clustcounts_randomorigin_.txt.2')
pbmc_nonwt = melt(pbmc_nonwt, id.vars=c('gridSize','max_min_dist', 'time'), measure.vars=c('b_cells','cd14_monocytes', "cd4_t_helper",   "cd56_nk",
"cytotoxic_t",    "memory_t",       "regulatory_t"))
pbmc_wt = melt(pbmc_wt, id.vars=c('gridSize','max_min_dist', 'time'), measure.vars=c('b_cells','cd14_monocytes', "cd4_t_helper",   "cd56_nk",
"cytotoxic_t",    "memory_t",       "regulatory_t"))
pbmc_grid_nonrandom = melt(pbmc_grid_nonrandom, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize", "N"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_nonwt_2 = melt(pbmc_nonwt_2, id.vars=c("max_min_dist","time","maxCounts","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
pbmc_grid_random = melt(pbmc_grid_random, id.vars=c("max_min_dist","time","maxCounts","randomize_origin","gridSize"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
View(pbmc_grid_nonrandom)
View(pbmc_nonwt)
pbmc_nonwt = fread('target/experiments/gsGridTest_clustcounts_nonwt.txt.1')
View(pbmc_nonwt)
pbmc_nonwt_2 = fread('target/experiments/pbmc_gsGridTest_clustcounts_nonwt.txt.1')
View(pbmc_nonwt_2)
pbmc_grid_nonrandom %>% filter(gridSize==0.3) %>%
ggplot(aes(x=N, y=value, color = variable))+
geom_line()
tree = fread('target/experiments/pbmc_treeLSHTest_clustcounts_.txt.1')
tree = melt(tree, id.vars=c("max_min_dist","time","occSquares", "children", "splitSize", "N"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
tree %>% ggplot(aes(x=N, y=value, color = variable))+
geom_line()
pbmc_grid_nonrandom %>% filter(gridSize==0.3) %>%
ggplot(aes(x=N, y=value, color = variable))+
geom_line()
tree %>% ggplot(aes(x=N, y=value, color = variable))+
geom_line()
tree = fread('target/experiments/pbmc_treeLSHTest_clustcounts_.txt.1')
tree = melt(tree, id.vars=c("max_min_dist","time","occSquares", "children", "splitSize", "N"),
measure.vars = c("CD14+_Monocyte","CD19+_B","CD4+/CD25_T_Reg","CD4+/CD45RA+/CD25-_Naive_T","CD4+/CD45RO+_Memory",
"CD4+_T_Helper2","CD56+_NK","CD8+/CD45RA+_Naive_Cytotoxic","CD8+_Cytotoxic_T","Dendritic"))
tree %>% ggplot(aes(x=N, y=value, color = variable))+
geom_line()
293t_tree = fread('target/experiments/293t_treeLSHTest_clustcounts.txt.1')
t_tree = fread('target/experiments/293t_treeLSHTest_clustcounts.txt.1')
View(t_tree)
t_tree %>% ggplot(aes(x=N, y=rare))+
geom_boxplot()
t_tree %>% ggplot(aes(x=N, y=rare))+
geom_boxplot(aes(group = N))
max(t_tree$rare)
View(sizetest)
View(pbmc_grid_nonrandom)
View(sizetest_rg)
t_tree = fread('target/experiments/293t_treeLSHTest_clustcounts.txt.2')
t_tree %>% ggplot(aes(x=N, y=rare))+
geom_boxplot(aes(group = N))
t_tree = fread('target/experiments/293t_treeLSHTest_clustcounts.txt.3')
t_tree %>% ggplot(aes(x=N, y=rare))+
geom_boxplot(aes(group = N))
sizetest_ball = fread('target/experiments/ballLSHTest.txt.1')
View(sizetest_ball)
sizetest_ball = fread('target/experiments/ballLSHTest.txt.2')
View(sizetest_ball)
