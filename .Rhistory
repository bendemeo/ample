kernel_advanced <- t %>%
distances() %>%
transform_advanced
print(sum(eigen(kernel_advanced,only.values=TRUE)$values<0))
%>%
distances()
t %>% distances
kernel_advanced[1,1]
s
cosh(s)
s<-2
s<-1
s
cosh(s)
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
kernel_advanced[1,1]
print(sum(eigen(kernel_advanced,only.values=TRUE)$values<0))
View(kernel_advanced)
kernel_advanced <- t %>%
distances()
kernel_advanced[1,2]
View(kernel_advanced)
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values<0))
t <- make_tree(n=100, children = 2, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 4, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
t <- make_tree(n=100, children = 5, mode='undirected')
kernel_advanced <- t %>%
distances()
kernel_advanced <- apply(kernel_advanced, c(1,2),function(x)cosh(s)^x)
print(sum(eigen(kernel_advanced,only.values=TRUE)$values>0))
?fread
?fRead
?read.table
library(tidyverse)
library(data.table)
?fRead
?fread
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_LSHparamtest.txt.1')
View(lsh_param_test_data)
?group
by_params <- lsh_param_test_data %>% group_by(numHashes, numBands, bandSize) %>%
summarise(rare=mean(rare))
View(by_params)
by_params <- lsh_param_test_data %>% group_by(numHashes, numBands, bandSize,replace) %>%
summarise(rare=mean(rare))
by_params <- lsh_param_test_data %>% group_by(numHashes, numBands, bandSize,replace, N) %>%
summarise(rare=mean(rare))
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line(aes(color=N))
?as.string
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line(aes(color=toString(N)))
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line(aes(group=N))
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line(aes(group=bandSize))
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line(aes(group=bandSize, color= N))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize))
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_LSHparamtest.txt.1')
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize,replace, N) %>%
summarise(rare=mean(rare))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(color=bandSize))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=bandSize))
toString(by_params$bandSize)
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString)))
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString)))
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize, N) %>%
summarise(rare=mean(rare))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString)))
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize, N) %>%
summarise(rare=mean(rare))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=N, y=rare))+
geom_line(aes(group=bandSize, color=sapply(bandSize,toString)))
by_params %>% ggplot(aes(x=bandSize, y=rare))+
geom_line()
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize, N) %>%
summarise(rare=mean(rare), kmeans_ami=mean(kmeans_ami))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=bandSize, y=kmeans_ami))+
geom_line()
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
library(tidyverse)
library(data.table)
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
View(lsh_param_test_data)
by_params <- lsh_param_test_data %>%
group_by(N, gridSize,sampler)
View(by_params)
by_params <- lsh_param_test_data %>%
group_by(gridSize,sampler)
by_params <- lsh_param_test_data %>%
group_by(gridSize,sampler)
by_params <- lsh_param_test_data %>%
group_by(gridSize,sampler)
by_params <- lsh_param_test_data %>%
group_by(gridSize)
by_params <- lsh_param_test_data %>%
group_by(N)
by_params <- lsh_param_test_data %>%
group_by(N, grid_size) %>%
summarise(rare = mean(rare))
by_params <- lsh_param_test_data %>%
group_by(N, gridSize) %>%
summarise(rare = mean(rare))
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_line()
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_line()
by_params <- lsh_param_test_data %>%
group_by(N, gridSize) %>%
summarise(rare = mean(rare), remnants=mean(remnants))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_line()
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_line(col=N)
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_line(color=N)
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_line(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_points(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))+
geom_line()
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_bandsize = lsh_param_test_data %>%
group_by(N, bandSize) %>%
summarise(rare = mean(rare))
View(by_bandsize)
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = N))
string(4)
as.char(2)
as.character(2)
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = apply(N, as.character)))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = apply(N, as.character)))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = sapply(N, as.character)))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = sapply(N, as.character)))
lsh_param_test_data$N = as.character(lsh_param_test_data$N)
lsh_param_test_data$N = as.character(lsh_param_test_data$N)
by_params <- lsh_param_test_data %>%
group_by(N, gridSize) %>%
summarise(rare = mean(rare), remnants=mean(remnants))
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize, N) %>%
summarise(rare=mean(rare), kmeans_ami=mean(kmeans_ami))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = N))
lsh_param_test_data$N = as.character(lsh_param_test_data$N)
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
lsh_param_test_data$N = as.character(lsh_param_test_data$N)
by_params <- lsh_param_test_data %>%
group_by(N, gridSize) %>%
summarise(rare = mean(rare), remnants=mean(remnants))
by_params <- lsh_param_test_data %>%
group_by(numHashes, numBands, bandSize, N) %>%
summarise(rare=mean(rare), kmeans_ami=mean(kmeans_ami))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = N))
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.1')
lsh_param_test_data$N = as.character(lsh_param_test_data$N)
by_params <- lsh_param_test_data %>%
group_by(N, gridSize) %>%
summarise(rare = mean(rare), remnants=mean(remnants))
# the number of rare cells seems stable as N increases, which is good.
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_smooth(aes(color = N))
by_params %>% ggplot(aes(x=gridSize, y=remnants))+
geom_point(aes(color=N))+
geom_line(aes(color = N))
by_params %>% ggplot(aes(x=gridSize, y=are))+
geom_point(aes(color=N))+
geom_line(aes(color = N))
by_params %>% ggplot(aes(x=gridSize, y=rare))+
geom_point(aes(color=N))+
geom_line(aes(color = N))
by_bandsize = lsh_param_test_data %>%
group_by(N, bandSize) %>%
summarise(rare = mean(rare), remnants = mean(remnants))
ggplot(by_bandsize, aes(x=bandSize,y=remnants))+
geom_point()
by_bandsize = lsh_param_test_data %>%
group_by(N, bandSize) %>%
summarise(rare = mean(rare), remnants = mean(remnants),
lastCounts = mean(lastCounts))
ggplot(by_bandsize, aes(x=bandSize,y=remnants))+
geom_point()
ggplot(by_bandsize, aes(x=bandSize,y=lastCounts))+
geom_point()
ggplot(by_bandsize, aes(x=bandSize,y=lastCounts))+
geom_point(aes(color=N))
lsh_param_test_data=fread('~/Documents/bergerlab/lsh/ample/target/experiments/293t_jurkat_lsh.txt.2')
ggplot(by_bandsize, aes(x=guess,y=actual))+
geom_point()
ggplot(lah_param_test_data, aes(x=guess,y=actual))+
geom_point()
ggplot(lsh_param_test_data, aes(x=guess,y=actual))+
geom_point()
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SIMLR")
browseVignettes('SIMLR')
library(SIMLR)
library(igraph)
?SIMLR
setwd('~/Documents/bergerlab/lsh/ample/bin/')
setwd('~/Documents/bergerlab/lsh/ample/')
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000')
library(dplyr)
setwd('~/Documents/bergerlab/lsh/ample/')
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000')
library(data.table)
setwd('~/Documents/bergerlab/lsh/ample/')
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000')
View(pbmc_1000)
?fread
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000', header=TRUE)
View(pbmc_1000)
library(SIMLR)
library(igraph)
library(dplyr)
library(data.table)
setwd('~/Documents/bergerlab/lsh/ample/')
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000', header=TRUE)
pbmc_1000$labels
?SIMLR
s = SIMLR(pbmc_1000)
table(pbmc_1000$labels)
s = SIMLR(pbmc_1000, c=10)
s = SIMLR(pbmc_1000[,1:100], c=10)
s = SIMLR(pbmc_1000[,1:100], c=12)
s = SIMLR(pbmc_1000[,1:100], c=10)
s
?SIMLR
s$S
dim(s$S)
s = SIMLR(t(pbmc_1000[,1:100]), c=10)
dim(s$S)
image(s$S)
View(s$S)
View(log(s$S))
image(log(s$S))
image(s$S == 0)
?SIMLR
pbmc_1000$labels
plot(s$ydata)
s$ydata
ggplot(s$ydata)+
geom_point()
library(ggplot)
library(ggplot2)
ggplot(s$ydata)+
geom_point()
dim(s$ydata)
data.frame(s$ydata)
ggplot(data.frame(s$ydata))+
geom_point()
colnames(s$ydata)
data.frame(s$ydata) %>% View()
ggplot(data.frame(s$ydata))+
geom_point(aes(x=X1, y=X2))
ggplot(data.frame(s$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_1000$labels))
?SIMLR
data("BuettnerFlorian")
data(BuettnerFlorian)
stest = SIMLR(X=BuettnerFlorian$in_X, c=BuettnerFlorian$n_clust, cores.ratio=0)
plot(stest$pydata,
col=c(topo.colors(BuettnerFlorian$n_clust))[BuettnerFlorian$true_labs[,1]],
pch=20)
plot(stest$ydata,
col=c(topo.colors(BuettnerFlorian$n_clust))[BuettnerFlorian$true_labs[,1]],
pch=20)
colnames(stest$ydata)
colnames(data.frame(stest$ydata))
ggplot(data.frame(stest$ydata))+
geom_point(aes(x=X1, y=X2))
c=BuettnerFlorian$n_clust
BuettnerFlorian
?SIMLR
BuettnerFlorian$true_labs
image(stest$S)
image(s$S)
View(BuettnerFlorian$in_X)
dim(BuettnerFlorian$in_X)
len(BuettnerFlorian$true_labs)
length(BuettnerFlorian$true_labs)
BuettnerFlorian$true_labs
stest$S %>% View()
s$S %>% View()
pbmc_200 = pbmc_1000[1:200,]
s2 = SIMLR(t(pbmc_200[,1:100]),c=10)
ggplot(data.frame(s2$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)
s2 = SIMLR(t(pbmc_200[,1:100]),c=10)
ggplot(data.frame(s2$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
install.packages('Rtsne')
library(Rtsne)
?Rtsne
dim(pbmc_200)
tsne = Rtsne(pbmc_200[,1:100])
plot(tsne$Y)
tsne$Y
?Rtnse
?Rtsne
tsne = Rtsne(pbmc_200[,1:100], perplexity=10,theta=0.0)
plot(tsne$Y)
pbmc_200$labels
?Rtsne
tsne = Rtsne(pbmc_200[,1:100], perplexity=10,theta=0.0, pca=FALSE)
tsne = Rtsne(pbmc_200[,1:100], perplexity=1,theta=0.0, pca=FALSE)
pbmc_200
pbmc_200[,1:100] %>% View()
tsne = Rtsne(pbmc_200[,1:100], perplexity=1,theta=0.0, pca=FALSE, verbose=TRUE)
s2 = SIMLR(t(pbmc_200[,1:100]),c=10)
tsne = Rtsne(pbmc_200[,1:100], perplexity=0.11,theta=0.0, pca=FALSE, verbose=TRUE)
tsne = Rtsne(pbmc_200[,1:100], perplexity=0.011,theta=0.0, pca=FALSE, verbose=TRUE)
plot(tsne$Y)
tsne = Rtsne(pbmc_200[,1:100], perplexity=0.0011,theta=0.0, pca=FALSE, verbose=TRUE)
tsne = Rtsne(pbmc_200[,1:100], perplexity=0.0011,theta=0.0, pca=FALSE, verbose=TRUE, max_iter=10000)
plot(tsne$Y)
View(pbmc_200)
View(pbmc_200[,1:100])
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)[,2:101]
View(pbmc_200)
tsne = Rtsne(pbmc_200)
plot(tsne$Y)
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)[,2:104]
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)[,2:103]
pbmc_200 = fread('data/pbmc/subsamples/ft_200', header=TRUE)[,2:102]
tsne = Rtsne(pbmc_200[,1:100])
colnames(tsne)
colnames(tsne=c('X','Y'))
colnames(tsne)=c('X','Y')
colnames(tsne$Y)=c('X','Y')
ggplot(cbind(tsne$Y, pbmc_200$labels))+
geom_point(aes(x=X, y=Y,color=labels))
cbind(tsne$Y, pbmc_200$labels)
ggplot(cbind(as.numeric(tsne$Y), pbmc_200$labels))+
geom_point(aes(x=X, y=Y,color=labels))
cbind(as.numeric(tsne$Y), pbmc_200$labels)
ggplot(tsne$Y)+
geom_point(aes(x=X, y=Y,color=pbmc_200$labels))
tsne = Rtsne(pbmc_200[,1:100])
colnames(tsne$Y)=c('X','Y')
ggplot(tsne$Y)+
geom_point(aes(x=X, y=Y))
tsne$Y
ggplot(tsne$Y)+
geom_point(aes(x=X, y=Y))
class(tsne$Y)
ggplot(data.frame(tsne$Y))+
geom_point(aes(x=X, y=Y))
ggplot(data.frame(tsne$Y))+
geom_point(aes(x=X, y=Y), color=pbmc_200$labels)
ggplot(d)+
geom_point(aes(x=X, y=Y, color=label))
tsne = Rtsne(pbmc_200[,1:100])
d = data.frame(tsne$Y)
d$labels = pbmc_200$labels
colnames(d)=c('X','Y', 'label')
ggplot(d)+
geom_point(aes(x=X, y=Y, color=label))
s2 = SIMLR(t(pbmc_200[,1:100]),c=10)
ggplot(data.frame(stest$ydata))+
geom_point(aes(x=X1, y=X2))
ggplot(data.frame(stest$ydata))+
geom_point(aes(x=X1, y=X2, color=pbmc_200$labels))
dim(stest$ydata)
pbmc_200$labels
ggplot(data.frame(s2$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
?SIMLR
ggplot(data.frame(s2$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
ggplot(d)+
geom_point(aes(x=X, y=Y, color=label))
ggplot(data.frame(s2$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
pbmc_1000 = fread('data/pbmc/subsamples/ft_1000', header=TRUE)[,2:102]
s = SIMLR(t(pbmc_1000[,1:100]), c=10)
ggplot(data.frame(s$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_200$labels))
ggplot(data.frame(s$ydata))+
geom_point(aes(x=X1, y=X2, color = pbmc_1000$labels))
s$S %>% image()
s$S %>% View()
s$S*1000 %>% image()
s$S*1000
dim(s$S*1000)
s$S*1000 %>% image()
as.matrix(s$S*1000) %>% image()
as.matrix(s$S*1000) %>% image()
as.matrix(1/s$S) %>% image()
as.matrix(log(s$S)) %>% image()
m = s$S
for(i %in% 1:nrow(m)){
m[i,]=rank(m[i,])
}
for(i in 1:nrow(m)){
m[i,]=rank(m[i,])
}
m[1,]
image(m)
m=(m+t(m))/2
image(m)
image(as.matrix(1000-m))
?SIMLR
s2$F
image(s$F)
image(as.matrix(1000-m))
pbmc_pca = fread(
pbmc_pca = fread('target/experiments/pbmc_PCALSH_hausdorff_backup.txt')
View(pbmc_pca)
zheng = fread('data/zheng/dimred.txt')
?SIMLR
zheng_simlr = SIMLR(t(zheng, c=5))
zheng = fread('data/zheng/dimred.txt')
zheng_simlr = SIMLR(t(zheng) c=5)
zheng_simlr = SIMLR(t(zheng), c=5)
